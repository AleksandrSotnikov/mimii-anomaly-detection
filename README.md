# MIMII Anomaly Detection

–ù–µ–π—Ä–æ—Å–µ—Ç–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π –≤ –∑–≤—É–∫–∞—Ö –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ MIMII.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–∫–ª–∞–ø–∞–Ω–æ–≤, –Ω–∞—Å–æ—Å–æ–≤, –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ–≤ –∏ –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏—Ö —Ä–µ–ª—å—Å–æ–≤) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–≤ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –±–µ–∑ —É—á–∏—Ç–µ–ª—è (unsupervised learning).

### –î–∞—Ç–∞—Å–µ—Ç MIMII

- **–ò—Å—Ç–æ—á–Ω–∏–∫**: [MIMII Dataset –Ω–∞ Zenodo](https://zenodo.org/records/3384388)
- **–†–∞–∑–º–µ—Ä**: 100.2 GB
- **–¢–∏–ø—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è**: valves, pumps, fans, slide rails
- **–§–æ—Ä–º–∞—Ç**: 8-–∫–∞–Ω–∞–ª—å–Ω—ã–µ –∞—É–¥–∏–æ –∑–∞–ø–∏—Å–∏, 16 kHz, 16-bit
- **–ö–ª–∞—Å—Å—ã**: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –∑–≤—É–∫–∏ (5000-10000 —Å–µ–∫) –∏ –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ (~1000 —Å–µ–∫)

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Python 3.9+**
- **PyTorch** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
- **Librosa** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã—Ö
- **NumPy, Pandas** - —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
- **Matplotlib, Seaborn** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- **Scikit-learn** - –º–µ—Ç—Ä–∏–∫–∏ –∏ preprocessing

### –ü–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é

**Autoencoder –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π**:
1. –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –∑–≤—É–∫–∞—Ö
2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (MFCC, Mel-—Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—ã)
3. –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. –î–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π –ø–æ –æ—à–∏–±–∫–µ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
mimii-anomaly-detection/
‚îú‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ requirements.txt          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ .gitignore               # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ config.yaml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ –∏ –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ data_loader.py       # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ MIMII
‚îÇ   ‚îú‚îÄ‚îÄ feature_extraction.py # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—É–¥–∏–æ-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ model.py             # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Autoencoder
‚îÇ   ‚îú‚îÄ‚îÄ train.py             # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ evaluate.py          # –û—Ü–µ–Ω–∫–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ utils.py             # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îî‚îÄ‚îÄ exploration.ipynb    # –ê–Ω–∞–ª–∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îî‚îÄ‚îÄ test_data_loader.py  # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ scripts/
    ‚îî‚îÄ‚îÄ download_dataset.sh  # –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ MIMII
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

```bash
# –°–∫–∞—á–∞–π—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç MIMII —Å Zenodo
# https://zenodo.org/records/3384388
# –†–∞—Å–ø–∞–∫—É–π—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é data/
```

### 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
python src/train.py --config config/config.yaml
```

### 4. –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏

```bash
python src/evaluate.py --checkpoint checkpoints/best_model.pth
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- **AUC-ROC** - –ø–ª–æ—â–∞–¥—å –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π
- **Precision/Recall** - —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω–æ—Ç–∞
- **F1-Score** - –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ
- **Reconstruction Error** - –æ—à–∏–±–∫–∞ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

## üîÑ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –°–ª–µ–¥–∏—Ç–µ –∑–∞ Issues –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## ü§ù –ö–æ–Ω—Ç—Ä–∏–±—å—é—Ü–∏—è

–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è pull requests –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –≤ Issues!

## üìö –°—Å—ã–ª–∫–∏

- [MIMII Dataset Paper (arXiv)](https://arxiv.org/abs/1909.09347)
- [DCASE 2019 Workshop](http://dcase.community/workshop2019/)
- [Baseline Code](https://github.com/MIMII-hitachi/mimii_baseline/)
